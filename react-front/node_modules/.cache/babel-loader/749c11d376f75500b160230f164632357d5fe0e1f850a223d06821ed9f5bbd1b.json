{"ast":null,"code":"import React,{useState,useEffect}from'react';import{getProductsRequest,createOrderRequest}from'../AuthP/products';import'../App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export const ProductList=()=>{const[products,setProducts]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{const fetchProducts=async()=>{try{const token=localStorage.getItem('token');if(!token){throw new Error('No se encontró token de autenticación');}const response=await getProductsRequest();console.log('Respuesta completa:',response);if(response.data&&Array.isArray(response.data.products)){setProducts(response.data.products);}else{throw new Error('La respuesta de la API no contiene un array de productos válido');}}catch(error){console.error('Error fetching products:',error);setError('Error al cargar los productos. Por favor, intenta de nuevo más tarde.');}finally{setLoading(false);}};fetchProducts();},[]);const handleBuy=async(productId,quantity)=>{try{const token=localStorage.getItem('token');if(!token){throw new Error('No se encontró token de autenticación');}await createOrderRequest({productIds:[productId],quantities:[quantity]});alert('¡Compra realizada con éxito!');}catch(error){console.error('Error creating order:',error.response?error.response.data:error.message);alert('Error al realizar la compra. Por favor, intenta de nuevo.');}};;const handleQuantityChange=(e,productId)=>{const quantity=parseInt(e.target.value,10);setProducts(products.map(product=>product.id===productId?{...product,selectedQuantity:quantity}:product));};if(loading){return/*#__PURE__*/_jsx(\"div\",{children:\"Cargando productos...\"});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"text-red-500\",children:error});}return/*#__PURE__*/_jsxs(\"div\",{className:\"product-list-container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold mb-4\",children:\"Lista de Productos\"}),products.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No hay productos disponibles.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"product-list\",children:products.map(product=>/*#__PURE__*/_jsxs(\"div\",{className:\"product-card\",children:[/*#__PURE__*/_jsx(\"div\",{children:product.image?/*#__PURE__*/_jsx(\"img\",{src:product.image,alt:\"Imagen del Producto\",style:{width:'100px',height:'auto'}}):/*#__PURE__*/_jsx(\"p\",{children:\"No disponible\"})}),/*#__PURE__*/_jsx(\"h2\",{className:\"product-name\",children:product.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-info\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"product-price\",children:[\"$\",product.price]}),/*#__PURE__*/_jsxs(\"p\",{className:\"product-quantity\",children:[\"Cantidad disponible: \",product.quantity]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-action\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:\"1\",max:product.quantity,value:product.selectedQuantity||1,onChange:e=>handleQuantityChange(e,product.id),className:\"product-quantity-input\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleBuy(product.id,product.selectedQuantity||1),className:\"product-buy-button\",disabled:product.quantity<1,children:\"Comprar\"})]})]},product.id))})]});};","map":{"version":3,"names":["React","useState","useEffect","getProductsRequest","createOrderRequest","jsx","_jsx","jsxs","_jsxs","ProductList","products","setProducts","loading","setLoading","error","setError","fetchProducts","token","localStorage","getItem","Error","response","console","log","data","Array","isArray","handleBuy","productId","quantity","productIds","quantities","alert","message","handleQuantityChange","e","parseInt","target","value","map","product","id","selectedQuantity","children","className","length","image","src","alt","style","width","height","name","price","type","min","max","onChange","onClick","disabled"],"sources":["C:/Users/Afthercaft/Pictures/ApiReact/react-front/src/pages/ProductList.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { getProductsRequest, createOrderRequest } from '../AuthP/products';\r\nimport '../App.css';\r\n\r\nexport const ProductList = () => {\r\n  const [products, setProducts] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const fetchProducts = async () => {\r\n      try {\r\n        const token = localStorage.getItem('token');\r\n        if (!token) {\r\n          throw new Error('No se encontró token de autenticación');\r\n        }\r\n        const response = await getProductsRequest();\r\n        console.log('Respuesta completa:', response);\r\n        \r\n        if (response.data && Array.isArray(response.data.products)) {\r\n          setProducts(response.data.products);\r\n        } else {\r\n          throw new Error('La respuesta de la API no contiene un array de productos válido');\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching products:', error);\r\n        setError('Error al cargar los productos. Por favor, intenta de nuevo más tarde.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchProducts();\r\n  }, []);\r\n\r\n  const handleBuy = async (productId, quantity) => {\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        throw new Error('No se encontró token de autenticación');\r\n      }\r\n      await createOrderRequest({ productIds: [productId], quantities: [quantity] });\r\n      alert('¡Compra realizada con éxito!');\r\n    } catch (error) {\r\n      console.error('Error creating order:', error.response ? error.response.data : error.message);\r\n      alert('Error al realizar la compra. Por favor, intenta de nuevo.');\r\n    }\r\n  };\r\n  ;\r\n\r\n  const handleQuantityChange = (e, productId) => {\r\n    const quantity = parseInt(e.target.value, 10);\r\n    setProducts(products.map(product => \r\n      product.id === productId ? { ...product, selectedQuantity: quantity } : product\r\n    ));\r\n  };\r\n\r\n  if (loading) {\r\n    return <div>Cargando productos...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"text-red-500\">{error}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"product-list-container\">\r\n      <h1 className=\"text-2xl font-bold mb-4\">Lista de Productos</h1>\r\n      {products.length === 0 ? (\r\n        <p>No hay productos disponibles.</p>\r\n      ) : (\r\n        <div className=\"product-list\">\r\n          {products.map(product => (\r\n            <div key={product.id} className=\"product-card\">\r\n              <div>\r\n                {product.image ? (\r\n                  <img src={product.image} alt=\"Imagen del Producto\" style={{ width: '100px', height: 'auto' }} />\r\n                ) : (\r\n                  <p>No disponible</p>\r\n                )}\r\n              </div>\r\n              <h2 className=\"product-name\">{product.name}</h2>\r\n              <div className=\"product-info\">\r\n                <p className=\"product-price\">${product.price}</p>\r\n                <p className=\"product-quantity\">Cantidad disponible: {product.quantity}</p>\r\n              </div>\r\n              <div className=\"product-action\">\r\n                <input\r\n                  type=\"number\"\r\n                  min=\"1\"\r\n                  max={product.quantity}\r\n                  value={product.selectedQuantity || 1}\r\n                  onChange={(e) => handleQuantityChange(e, product.id)}\r\n                  className=\"product-quantity-input\"\r\n                />\r\n                <button\r\n                  onClick={() => handleBuy(product.id, product.selectedQuantity || 1)}\r\n                  className=\"product-buy-button\"\r\n                  disabled={product.quantity < 1}\r\n                >\r\n                  Comprar\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}